<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>M.I.E.C. • Login</title>
  <link rel="stylesheet" href="css/styles.css?v=418" />
  <link rel="icon" type="image/png" href="images/favicon.png" />
  <!-- Core scripts -->
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.56.0"></script>
  <script defer src="js/config.js?v=418"></script>
  <script defer src="js/supa.js?v=418"></script>

  <!-- INLINE compat bridge: guarantees window.supa.* exists even if external compat file is missing -->
  <script>
  (function(){
    function install(){
      if (!window.supa) {
        window.supa = {
          loginMagic: (...a)=>window.SupaAuth?window.SupaAuth.loginMagic(...a):Promise.reject(new Error("Auth not ready")),
          sendEmailOtp: (...a)=>window.SupaAuth?window.SupaAuth.sendEmailOtp(...a):Promise.reject(new Error("Auth not ready")),
          sendOtpOnly: (...a)=>window.SupaAuth?window.SupaAuth.sendEmailOtp(...a):Promise.reject(new Error("Auth not ready")),
          verifyCode: (...a)=>window.SupaAuth?window.SupaAuth.verifyCode(...a):Promise.reject(new Error("Auth not ready")),
          getSession: (...a)=>window.SupaAuth?window.SupaAuth.getSession(...a):Promise.resolve({data:null}),
          getUser: async ()=>{ try{ const {data}=await(window.SupaAuth?window.SupaAuth.getSession():Promise.resolve({data:null})); return {user:data?.session?.user||null}; }catch(e){ return {user:null}; } },
          logout: (...a)=>window.SupaAuth?window.SupaAuth.logout(...a):null,
        };
      }
    }
    install();
    document.addEventListener("supa:ready", install);
  })();
  </script>

  <!-- Page scripts (your existing logic) -->
  <script defer src="js/cloud-diag.js?v=418"></script>
</head>
<body>
  <!-- O teu markup original deve permanecer no ficheiro do repo. 
       Este template é apenas para garantir a ordem e a ponte inline. -->
  <div style="max-width:760px;margin:40px auto;padding:24px;border:1px solid #e5e7eb;border-radius:16px">
    <h1>M.I.E.C. • Login</h1>
    <p>Se estiveres a ver isto, o teu login.html do repo não foi usado. Podes copiar apenas a parte do <head>.</p>
  </div>
</body>
</html>
