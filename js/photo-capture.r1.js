/*! photo-capture.r1.js */(function(){function e(t){document.readyState==='complete'?t():addEventListener('load',t,{once:true})}e(()=>{['winPhoto','motorPhoto'].forEach(t=>{const a=document.getElementById(t);if(!a)return;a.setAttribute('accept','image/*');a.setAttribute('capture','environment');a.addEventListener('change',async()=>{const n=a.files&&a.files[0];if(!n)return;try{const r=await o(n,1600,1200,0.75);const c=new DataTransfer();c.items.add(r);a.files=c.files;a.dispatchEvent(new Event('miec:photo:compressed'))}catch(s){console.warn('[photo-capture] falhou:',s)}})})});function o(t,a,n,r){return new Promise((c,s)=>{const i=new Image(),l=URL.createObjectURL(t);i.onload=()=>{const u=Math.min(a/i.width,n/i.height,1),d=Math.round(i.width*u),h=Math.round(i.height*u),f=document.createElement('canvas');f.width=d;f.height=h;f.getContext('2d').drawImage(i,0,0,d,h);f.toBlob(g=>{if(!g)return s(new Error('blob null'));URL.revokeObjectURL(l);c(new File([g],t.name.replace(/\.(\w+)?$/i,'.jpg'),{type:'image/jpeg',lastModified:Date.now()}))},'image/jpeg',r)};i.onerror=s;i.src=l})}})();